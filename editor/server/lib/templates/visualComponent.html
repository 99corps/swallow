<html>
<head>
    <title>${type}</title>
<title>Time</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="viewport" content = "width = device-width, initial-scale = 1, user-scalable = no" />
{{each css}}    <link rel="stylesheet" type="text/css" href="${$value}">


{{/each}}
{{if icon}}
                <link rel="icon" href="${icon}">
                <link rel="apple-touch-icon" href="${icon}"/>
{{/if}}
    <script src = "pillow.js"></script>
{{each dependencies}}    <script src = "${$value}"></script>
{{/each}}
    <script>
        window.onload = function () {
            var pillow = define.pillow,
                require = pillow.makeRequire(pillow.createApplicationDomain(), '');

{{if jquery}}
            pillow.supportJQuery(require);
{{/if}}
{{if editFactory}}
            new (require('${factory}').${type})().loadGroup('${editFactory}', '${editType}').runFullScreen();
{{else}}
            new (require('${factory}').${type})().runFullScreen();
{{/if}}

{{if monitor}}
            // monitoring will reload the app on any change
            (function () {
                var es = new window.EventSource('/swallow/events');
                es.addEventListener('monitor', function (evt) {
                    var ti = JSON.parse(evt.data);
                    window.location = ti.factory + '.' + ti.type + '.mon';
                });
                es.addEventListener('savecomponent', function (evt) {
                    var ti = JSON.parse(evt.data);
                    if (ti.factory === '${factory}' && ti.type === '${type}') {
                        window.location = ti.factory + '.' + ti.type + '.mon';
                    }
                });
            }());
{{/if}}
        }
    </script>
</head>
<body>
</body>
</html>
